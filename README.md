# 斯大林格勒：钢铁战线指挥图（UI升级版）

本版本把原先“按钮平铺”升级为**手机优先的兵棋指挥席**，保持硬核、干净、军事感的深色风格，并提供可演示的指挥交互框架。

## 本地预览

```bash
npm install
npm run dev
```

默认地址：`http://localhost:5173`

## 打包与部署

```bash
npm run build
npm run preview
```

构建产物在 `dist/`，可部署到任意静态站点（Nginx / GitHub Pages / Vercel 静态托管）。

## UI结构说明

### A. 三段式布局

1. **Top Bar（固定）**
   - 回合、当前阵营、AP、补给状态（通/断/危）
   - 模式切换（浏览/指挥）、居中、日志、设置
   - 居中支持短按/长按：
     - 短按：居中到当前选中单位
     - 长按：打开快速跳转（最近单位/关键节点/补给点，mock）

2. **Unit Panel（左侧/移动端半抽屉）**
   - 单位树（集团军→军→师→团→营，mock层级）
   - 筛选：可行动、缺补给、受损、已行动
   - 搜索框
   - 点选单位后：地图高亮 + Top Bar / Action Dock 同步刷新

3. **Action Dock（底部固定）**
   - 只展示当前单位动作：机动/突击/火力/筑垒/补给
   - 每个动作显示 AP 消耗
   - 不可用动作置灰，点击/长按给出原因（缺AP、无补给、距离不够、地形限制等）
   - 包含“回合结束 / 重置战区”

### B. 地图交互框架

- **浏览模式/指挥模式**（误触保护）
- 选中单位后可显示：
  - 移动范围高亮（简化规则）
  - 攻击圈/LOS圈开关（范围圈占位）
- **动作二段式确认**：
  1) 点击动作进入规划态
  2) 地图点选目标后出现确认条（确认/取消）
  3) 执行后显示 toast 并写入回合日志

### C. 信息面板

- **战况面板**：VP、补给线状态、损失统计（卡片）
- **单位卡**：编制、装备、状态、指挥链、AP已用/剩余

## 代码组织

- `src/main.ts`：应用装配、输入响应、地图渲染与 UI 刷新
- `src/state/store.ts`：UI状态/动作可用性/日志/二段确认
- `src/ui/topbar.ts`：顶部栏与模式/居中/设置/日志交互
- `src/ui/panels.ts`：单位树、筛选、搜索、战况与单位卡
- `src/ui/actions.ts`：底部动作条、动作禁用原因、确认条
- `src/style.css`：统一军事风格视觉、移动端安全区、触屏尺寸规范

## 可演示清单

- ✅ 选中单位 → 地图高亮与信息联动
- ✅ 动作条按当前单位状态刷新（含禁用原因提示）
- ✅ 二段确认（规划态 → 目标 → 确认）
- ✅ 回合日志写入与 toast 反馈
- ✅ 面板切换（战况/单位卡、日志、设置）

